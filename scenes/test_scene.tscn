[gd_scene load_steps=19 format=3 uid="uid://c1kv01nehjtg4"]

[ext_resource type="PackedScene" uid="uid://bnnh20ail45mt" path="res://prefabs/character/player.tscn" id="1_a4kte"]
[ext_resource type="Script" path="res://scripts/gameplay/world.gd" id="1_a563s"]
[ext_resource type="PackedScene" uid="uid://djuaoq7blvrls" path="res://prefabs/collectables/coin.tscn" id="2_76xuq"]
[ext_resource type="PackedScene" uid="uid://siaojteegwfd" path="res://prefabs/gameplay/enemy.tscn" id="7_kp4ib"]
[ext_resource type="PackedScene" uid="uid://c10q6utmqmbrk" path="res://prefabs/gameplay/hit_screen.tscn" id="8_f6djn"]
[ext_resource type="PackedScene" uid="uid://dkbtgrdu35uav" path="res://prefabs/gameplay/hud.tscn" id="10_32m7w"]
[ext_resource type="PackedScene" uid="uid://bcgx7pq0b3mj5" path="res://prefabs/gameplay/npc.tscn" id="12_hvcg7"]
[ext_resource type="PackedScene" uid="uid://djiycmbjjnmqw" path="res://prefabs/gameplay/shootingEnemy.tscn" id="12_o3a7f"]
[ext_resource type="PackedScene" uid="uid://cfq0aps387o0v" path="res://prefabs/gameplay/projectile.tscn" id="13_x53tx"]
[ext_resource type="PackedScene" uid="uid://c866pdji0vdsm" path="res://prefabs/gameplay/sensors/pressure_plate.tscn" id="15_escu1"]
[ext_resource type="PackedScene" uid="uid://vatto345e7s0" path="res://prefabs/gameplay/platforming/pushable_block.tscn" id="16_ne154"]
[ext_resource type="PackedScene" uid="uid://bn05oc16bv8kd" path="res://prefabs/gameplay/platforming/moving_block.tscn" id="16_r1ouv"]

[sub_resource type="ProceduralSkyMaterial" id="ProceduralSkyMaterial_kxnp8"]

[sub_resource type="Sky" id="Sky_xu4jj"]
sky_material = SubResource("ProceduralSkyMaterial_kxnp8")

[sub_resource type="Environment" id="Environment_oaslu"]
background_mode = 2
sky = SubResource("Sky_xu4jj")

[sub_resource type="NavigationMesh" id="NavigationMesh_h2xih"]
vertices = PackedVector3Array(-3.56287, 2.80249, -45.0835, -5.06287, 2.80249, -43.8335, -5.06287, 2.80249, -43.3335, -2.06287, 2.80249, -43.0835, 4.18713, 2.80249, -45.0835, 5.68713, 2.80249, -43.3335, 4.18713, 2.80249, -45.0835, -2.06287, 2.80249, -43.0835, -2.06287, 2.80249, -33.8335, 3.43713, 2.80249, -35.3335, -2.06287, 2.80249, -33.8335, 3.18713, 2.80249, -33.5835, 3.43713, 2.80249, -35.3335, 3.43713, 2.80249, -35.3335, 5.68713, 2.80249, -35.3335, 5.68713, 2.80249, -43.3335, -2.56287, 2.80249, -28.8335, -2.56287, 3.05249, -31.3335, -3.06287, 3.05249, -31.3335, -5.31287, 2.80249, -28.8335, -3.06287, 3.05249, -31.3335, -3.06287, 8.55249, -42.3335, -5.31287, 8.55249, -42.3335, -5.31287, 2.80249, -28.8335, -5.31287, 3.05249, -31.5335, -4.81287, 2.80249, -42.0835, -4.81287, 2.80249, -40.3335, -3.31287, 2.80249, -40.3335, -3.31287, 2.80249, -42.0835, -4.81287, 5.80249, -42.0835, -4.81287, 5.80249, -40.8335, -3.31287, 5.80249, -40.8335, -3.31287, 5.80249, -42.0835, -4.81287, 2.80249, -39.0835, -4.81287, 2.80249, -37.3335, -3.31287, 2.80249, -37.3335, -3.31287, 2.80249, -39.0835, -4.81287, 2.80249, -36.0835, -4.81287, 2.80249, -34.8335, -3.31287, 2.80249, -34.8335, -3.31287, 2.80249, -36.0835, 3.93713, 6.55249, -34.0835, 4.18713, 6.55249, -33.3335, 5.18713, 6.55249, -33.5835, 4.68713, 6.55249, -34.5835, -2.06287, 2.80249, -28.5835, -2.06287, 2.80249, -27.5835, -0.0628681, 2.80249, -27.5835, -0.312868, 2.80249, -29.5835, 3.18713, 2.80249, -33.5835, -2.06287, 2.80249, -33.8335, -2.06287, 2.80249, -31.3335, 0.187132, 2.80249, -30.0835, 3.18713, 2.80249, -30.0835, 3.43713, 2.80249, -32.5835, -2.56287, 2.80249, -28.8335, -2.06287, 2.80249, -28.5835, -0.312868, 2.80249, -29.5835, 0.187132, 2.80249, -30.0835, -2.06287, 2.80249, -31.3335, -2.56287, 3.05249, -31.3335, 3.18713, 2.80249, -30.0835, 3.68713, 2.80249, -29.0835, 5.68713, 2.80249, -29.0835, 5.68713, 2.80249, -32.5835, 3.43713, 2.80249, -32.5835, 10.4371, 2.80249, -25.5835, 11.4371, 2.80249, -26.0835, 10.9371, 2.80249, -27.0835, 9.68713, 2.80249, -27.8335, 5.93713, 2.80249, -27.8335, 7.43713, 2.80249, -25.5835, 5.93713, 2.80249, -27.8335, 5.68713, 2.80249, -29.0835, 3.68713, 2.80249, -29.0835, 3.68713, 2.80249, -26.5835, 3.93713, 2.80249, -23.8335, 4.43713, 2.80249, -22.5835, 6.93713, 2.80249, -22.5835, 7.43713, 2.80249, -25.5835, 5.93713, 2.80249, -27.8335, 3.68713, 2.80249, -26.5835, 2.43713, 2.80249, -26.3335, 2.43713, 2.80249, -23.8335, 3.93713, 2.80249, -23.8335, 3.68713, 2.80249, -26.5835, 10.4371, 2.80249, -25.5835, 10.6871, 2.80249, -22.5835, 11.4371, 2.80249, -22.5835, 11.4371, 2.80249, -26.0835, 0.937132, 6.55249, -28.8335, 0.937132, 6.55249, -27.5835, 2.43713, 6.55249, -27.5835, 2.43713, 6.55249, -28.8335, -8.81287, 5.80249, -19.3335, -11.0629, 5.80249, -18.8335, -10.0629, 5.80249, -17.3335, -9.06287, 5.80249, -16.8335, 0.187132, 3.05249, -16.8335, -0.0628681, 3.05249, -19.3335, -5.8962, 5.80249, -19.3335, -5.09858, 5.55249, -16.8335, -8.81287, 8.55249, -25.3335, -3.06287, 8.55249, -25.5835, -3.06287, 8.55249, -27.8335, -9.06287, 8.55249, -27.8335, -10.8129, 8.55249, -26.5835, -8.81287, 8.55249, -25.3335, -10.8129, 8.55249, -26.5835, -11.0629, 5.80249, -18.8335, -8.81287, 5.80249, -19.3335, -10.8545, 8.55249, -25.2918, -11.0212, 6.05249, -20.1252, -7.81287, 2.80249, -27.5835, -7.81287, 2.80249, -25.8335, -6.06287, 2.80249, -25.8335, -6.06287, 2.80249, -27.5835, -7.81287, 5.80249, -27.5835, -7.81287, 5.80249, -25.8335, -6.06287, 5.80249, -25.8335, -6.06287, 5.80249, -27.5835, -4.81287, 2.80249, -27.5835, -4.81287, 2.80249, -25.8335, -3.31287, 2.80249, -25.8335, -3.31287, 2.80249, -27.5835, -4.81287, 5.80249, -27.5835, -4.81287, 5.80249, -25.8335, -3.31287, 5.80249, -25.8335, -3.31287, 5.80249, -27.5835, -0.0628681, 2.80249, -19.8335, 2.18713, 2.80249, -21.0835, 1.68713, 2.80249, -21.3335, 0.187132, 2.80249, -26.3335, -0.0628681, 2.80249, -27.5835, -2.06287, 2.80249, -27.5835, -2.06287, 2.80249, -24.8335, -0.0628681, 2.80249, -19.8335, 1.68713, 2.80249, -21.3335, 1.68713, 2.80249, -23.3335, -2.06287, 2.80249, -24.8335, -4.31287, 2.80249, -24.5835, -4.31287, 2.80249, -20.0835, 1.68713, 2.80249, -23.3335, 2.43713, 2.80249, -23.8335, 2.43713, 2.80249, -26.3335, 0.187132, 2.80249, -26.3335, -2.06287, 2.80249, -24.8335, -10.5629, 2.80249, -26.0835, -9.06287, 2.80249, -25.8335, -9.06287, 2.80249, -27.3335, -10.5629, 5.80249, -26.0835, -9.06287, 5.80249, -25.8335, -9.06287, 5.80249, -27.3335, -13.8129, 2.80249, -19.8335, -12.0629, 2.80249, -19.8335, -11.8129, 2.80249, -23.0835, -13.8129, 2.80249, -24.8335, -13.8129, 2.80249, -24.8335, -11.8129, 2.80249, -23.0835, -8.06287, 2.80249, -23.0835, -4.31287, 2.80249, -24.5835, -8.06287, 2.80249, -23.0835, -7.81287, 2.80249, -20.0835, -4.31287, 2.80249, -20.0835, -4.31287, 2.80249, -24.5835, 8.18713, 6.55249, -23.3335, 8.68713, 6.55249, -22.8335, 9.68713, 6.55249, -23.0835, 9.43713, 6.55249, -24.5835, 8.18713, 6.55249, -24.5835, 3.18713, 6.55249, -21.5835, 3.68713, 6.55249, -21.8335, 3.68713, 6.55249, -22.5835, 3.18713, 6.55249, -22.8335, 2.43713, 6.55249, -22.3335, 11.4371, 2.80249, -22.5835, 10.6871, 2.80249, -22.5835, 10.4371, 2.80249, -21.8335, 11.1871, 2.80249, -20.8335, 7.43713, 2.80249, -21.8335, 4.43713, 2.80249, -22.5835, 4.18713, 2.80249, -21.0835, 8.43713, 2.80249, -18.3335, 8.93713, 2.80249, -19.8335, 9.93713, 2.80249, -19.8335, 11.1871, 2.80249, -20.8335, 10.4371, 2.80249, -21.8335, 7.43713, 2.80249, -21.8335, 8.93713, 2.80249, -19.8335, 2.18713, 2.80249, -14.0835, 8.93713, 2.80249, -16.0835, 8.43713, 2.80249, -16.5835, 4.18713, 2.80249, -21.0835, -0.0628681, 3.05249, -19.3335, 0.687132, 2.80249, -16.5835, 2.18713, 2.80249, -14.0835, 8.43713, 2.80249, -16.5835, 8.43713, 2.80249, -18.3335, 2.18713, 2.80249, -21.0835, -0.0628681, 2.80249, -19.8335, -0.0628681, 3.05249, -19.3335, 4.18713, 2.80249, -21.0835, -0.0628681, 3.05249, -19.3335, 0.187132, 3.05249, -16.8335, 0.687132, 2.80249, -16.5835, 0.687132, 2.80249, -16.5835, 0.937132, 2.80249, -15.0835, 2.18713, 2.80249, -14.0835, 7.43713, 2.80249, -21.8335, 6.93713, 2.80249, -22.5835, 4.43713, 2.80249, -22.5835, 11.4371, 2.80249, -14.0835, 11.4371, 2.80249, -16.0835, 8.93713, 2.80249, -16.0835, 2.18713, 2.80249, -14.0835, -10.8129, 2.80249, -21.8335, -10.8129, 2.80249, -20.0835, -9.06287, 2.80249, -20.0835, -9.06287, 2.80249, -21.8335, -10.3129, 2.80249, -18.0835, -9.06287, 2.80249, -17.3335, -9.06287, 2.80249, -18.8335, -10.5629, 2.80249, -18.8335, -7.81287, 2.80249, -18.8335, -7.81287, 2.80249, -17.0835, -6.06287, 2.80249, -17.0835, -6.06287, 2.80249, -18.8335, -4.81287, 2.80249, -18.8335, -4.81287, 2.80249, -17.0835, -3.56287, 2.80249, -17.0835, -3.56287, 2.80249, -18.8335, -9.56287, 0.802488, -9.5835, -9.56287, 0.802488, 9.4165, 9.68713, 0.802488, 9.4165, 9.68713, 0.802488, -9.5835)
polygons = [PackedInt32Array(1, 0, 2), PackedInt32Array(2, 0, 3), PackedInt32Array(3, 0, 4), PackedInt32Array(6, 5, 7), PackedInt32Array(7, 5, 9), PackedInt32Array(7, 9, 8), PackedInt32Array(12, 11, 10), PackedInt32Array(15, 14, 13), PackedInt32Array(17, 16, 18), PackedInt32Array(18, 16, 19), PackedInt32Array(23, 24, 20), PackedInt32Array(20, 24, 22), PackedInt32Array(20, 22, 21), PackedInt32Array(28, 27, 25), PackedInt32Array(25, 27, 26), PackedInt32Array(32, 31, 29), PackedInt32Array(29, 31, 30), PackedInt32Array(36, 35, 33), PackedInt32Array(33, 35, 34), PackedInt32Array(40, 39, 37), PackedInt32Array(37, 39, 38), PackedInt32Array(41, 44, 42), PackedInt32Array(42, 44, 43), PackedInt32Array(46, 45, 47), PackedInt32Array(47, 45, 48), PackedInt32Array(54, 53, 49), PackedInt32Array(49, 53, 52), PackedInt32Array(49, 52, 51), PackedInt32Array(49, 51, 50), PackedInt32Array(56, 55, 57), PackedInt32Array(57, 55, 58), PackedInt32Array(58, 55, 59), PackedInt32Array(59, 55, 60), PackedInt32Array(62, 61, 63), PackedInt32Array(63, 61, 65), PackedInt32Array(63, 65, 64), PackedInt32Array(67, 66, 68), PackedInt32Array(68, 66, 69), PackedInt32Array(69, 66, 71), PackedInt32Array(69, 71, 70), PackedInt32Array(73, 72, 74), PackedInt32Array(74, 72, 75), PackedInt32Array(77, 76, 78), PackedInt32Array(78, 76, 79), PackedInt32Array(79, 76, 81), PackedInt32Array(79, 81, 80), PackedInt32Array(82, 85, 83), PackedInt32Array(83, 85, 84), PackedInt32Array(87, 86, 88), PackedInt32Array(88, 86, 89), PackedInt32Array(93, 92, 90), PackedInt32Array(90, 92, 91), PackedInt32Array(96, 95, 97), PackedInt32Array(97, 95, 94), PackedInt32Array(97, 94, 100), PackedInt32Array(97, 100, 101), PackedInt32Array(101, 100, 99), PackedInt32Array(101, 99, 98), PackedInt32Array(106, 105, 102), PackedInt32Array(102, 105, 103), PackedInt32Array(103, 105, 104), PackedInt32Array(108, 107, 111), PackedInt32Array(111, 107, 112), PackedInt32Array(112, 107, 109), PackedInt32Array(109, 107, 110), PackedInt32Array(116, 115, 113), PackedInt32Array(113, 115, 114), PackedInt32Array(120, 119, 117), PackedInt32Array(117, 119, 118), PackedInt32Array(124, 123, 121), PackedInt32Array(121, 123, 122), PackedInt32Array(128, 127, 125), PackedInt32Array(125, 127, 126), PackedInt32Array(131, 130, 129), PackedInt32Array(133, 132, 134), PackedInt32Array(134, 132, 135), PackedInt32Array(137, 136, 138), PackedInt32Array(138, 136, 139), PackedInt32Array(139, 136, 140), PackedInt32Array(140, 136, 141), PackedInt32Array(143, 142, 144), PackedInt32Array(144, 142, 145), PackedInt32Array(145, 142, 146), PackedInt32Array(149, 148, 147), PackedInt32Array(152, 151, 150), PackedInt32Array(154, 153, 155), PackedInt32Array(155, 153, 156), PackedInt32Array(158, 157, 159), PackedInt32Array(159, 157, 160), PackedInt32Array(162, 161, 163), PackedInt32Array(163, 161, 164), PackedInt32Array(166, 165, 167), PackedInt32Array(167, 165, 168), PackedInt32Array(168, 165, 169), PackedInt32Array(171, 170, 172), PackedInt32Array(172, 170, 173), PackedInt32Array(173, 170, 174), PackedInt32Array(176, 175, 177), PackedInt32Array(177, 175, 178), PackedInt32Array(183, 182, 179), PackedInt32Array(179, 182, 181), PackedInt32Array(179, 181, 180), PackedInt32Array(185, 184, 186), PackedInt32Array(186, 184, 188), PackedInt32Array(186, 188, 187), PackedInt32Array(191, 190, 189), PackedInt32Array(194, 193, 195), PackedInt32Array(195, 193, 192), PackedInt32Array(195, 192, 197), PackedInt32Array(195, 197, 196), PackedInt32Array(199, 198, 200), PackedInt32Array(200, 198, 201), PackedInt32Array(204, 203, 202), PackedInt32Array(207, 206, 205), PackedInt32Array(210, 209, 208), PackedInt32Array(212, 211, 213), PackedInt32Array(213, 211, 214), PackedInt32Array(218, 217, 215), PackedInt32Array(215, 217, 216), PackedInt32Array(222, 221, 219), PackedInt32Array(219, 221, 220), PackedInt32Array(226, 225, 223), PackedInt32Array(223, 225, 224), PackedInt32Array(230, 229, 227), PackedInt32Array(227, 229, 228), PackedInt32Array(234, 233, 231), PackedInt32Array(231, 233, 232)]
agent_max_slope = 60.0

[sub_resource type="BoxShape3D" id="BoxShape3D_wia5q"]
size = Vector3(5, 0.2, 5)

[sub_resource type="BoxMesh" id="BoxMesh_flhtq"]
size = Vector3(5, 0.2, 5)

[node name="World" type="Node3D"]
script = ExtResource("1_a563s")

[node name="Player" parent="." instance=ExtResource("1_a4kte")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -1.05404, 2.38031, -2.39319)

[node name="WorldEnvironment" type="WorldEnvironment" parent="."]
environment = SubResource("Environment_oaslu")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.938095, 0.346379, 0, -0.346379, 0.938095, 0, 9.6073, -2.04355)
light_color = Color(0.0941176, 0.0941176, 0.0941176, 1)

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="."]
transform = Transform3D(0.999988, -0.00431918, 0.00242561, 0.00431627, 0.99999, 0.00120264, -0.00243078, -0.00119215, 0.999996, 0, 0, 0)
navigation_mesh = SubResource("NavigationMesh_h2xih")

[node name="StaticBody3D" type="StaticBody3D" parent="NavigationRegion3D"]
transform = Transform3D(4, 0, 0, 0, 4, 0, 0, 0, 4, 0, 0, 0)

[node name="CollisionShape3D" type="CollisionShape3D" parent="NavigationRegion3D/StaticBody3D"]
shape = SubResource("BoxShape3D_wia5q")

[node name="MeshInstance3D" type="MeshInstance3D" parent="NavigationRegion3D/StaticBody3D"]
mesh = SubResource("BoxMesh_flhtq")

[node name="StaticBody3D3" type="StaticBody3D" parent="NavigationRegion3D"]
transform = Transform3D(4, 1.7917e-10, 0, 2.35559e-10, 4, 0, 0, 0, 4, -0.0449816, -0.0220609, 18.5049)

[node name="CollisionShape3D" type="CollisionShape3D" parent="NavigationRegion3D/StaticBody3D3"]
shape = SubResource("BoxShape3D_wia5q")

[node name="MeshInstance3D" type="MeshInstance3D" parent="NavigationRegion3D/StaticBody3D3"]
mesh = SubResource("BoxMesh_flhtq")

[node name="Coin" parent="." instance=ExtResource("2_76xuq")]
transform = Transform3D(2.505, 0, 0, 0, 2.505, 0, 0, 0, 2.505, 4, 2, -2.42387)

[node name="Coin2" parent="." instance=ExtResource("2_76xuq")]
transform = Transform3D(2.505, 0, 0, 0, 2.505, 0, 0, 0, 2.505, 6.91907, 2, -2.42387)

[node name="HUD" parent="." instance=ExtResource("10_32m7w")]
num_of_coins = 2

[node name="Enemy" parent="." instance=ExtResource("7_kp4ib")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 6.79472, 1.36003, -33.1467)
player_path = NodePath("../Player")
follow_distance = 20.0

[node name="ShootingEnemy" parent="." instance=ExtResource("12_o3a7f")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 2.51103, 1.99317, -22.2755)
player_path = NodePath("../Player")
projectile_scene = ExtResource("13_x53tx")

[node name="HitScreen" parent="." instance=ExtResource("8_f6djn")]

[node name="NPC" parent="." instance=ExtResource("12_hvcg7")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.95694, -8.60229)

[node name="Projectile" parent="." instance=ExtResource("13_x53tx")]

[node name="PressurePlate" parent="." instance=ExtResource("15_escu1")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.321396, 0.412443, -6.12274)
direction = 3

[node name="PushableBlock" parent="." instance=ExtResource("16_ne154")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 4.61699, 1.05853, -6.59029)

[node name="MovingBlock" parent="." instance=ExtResource("16_r1ouv")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.42735, 1.35471, -9.24048)
signal_emitter_path = NodePath("../PressurePlate")

[node name="CharacterBody3D" parent="." instance=ExtResource("16_ne154")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.23391, 0)

[connection signal="player_hit" from="Player" to="." method="_on_player_player_hit"]
[connection signal="player_hit" from="Player" to="HUD" method="_on_player_player_hit"]
[connection signal="coin_collected" from="Coin" to="HUD" method="_on_coin_coin_collected"]
[connection signal="coin_collected" from="Coin2" to="HUD" method="_on_coin_coin_collected"]
